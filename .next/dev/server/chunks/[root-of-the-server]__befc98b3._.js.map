{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abdul/Downloads/PayFlow/app/api/initialize/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { email, amount, fullName } = await req.json();\r\n\r\n        const amountInKobo = Math.round(Number(amount) * 100);\r\n\r\n        if (!email || !amountInKobo || !fullName) {\r\n            return NextResponse.json({ error: \"Email, full name, and amount are required.\" }, { status: 400 });\r\n        }\r\n\r\n        if (amountInKobo < 10000) { // 100 NGN\r\n            return NextResponse.json({ error: 'Minimum amount is â‚¦100' },{ status: 400 });\r\n        }\r\n\r\n        const paystackResponse = await fetch(\"https://api.paystack.co/transaction/initialize\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                Authorization: `Bearer ${process.env.PAYSTACK_SECRET_KEY}`,\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({\r\n                email,\r\n                amount: amountInKobo,\r\n                callback_url: `${process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:3000\"}/verify`,\r\n                metadata: {\r\n                    full_name: fullName,\r\n                    custom_fields: [],\r\n                },\r\n            })\r\n        });\r\n\r\n        const data = await paystackResponse.json();\r\n\r\n        if (!paystackResponse.ok) {\r\n            console.error(\"Paystack initialization error:\", data);\r\n            return NextResponse.json({ error: data.message || \"Failed to initialize transaction.\" }, { status: paystackResponse.status });\r\n        }\r\n\r\n\r\n        return NextResponse.json({\r\n            authorization_url: data.data.authorization_url,\r\n            access_code: data.data.access_code,\r\n            reference: data.data.reference,\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Server error during Paystack initialization:\", error);\r\n        return NextResponse.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n    } \r\n}"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAElD,MAAM,eAAe,KAAK,KAAK,CAAC,OAAO,UAAU;QAEjD,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU;YACtC,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA6C,GAAG;gBAAE,QAAQ;YAAI;QACpG;QAEA,IAAI,eAAe,OAAO;YACtB,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAE;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,mBAAmB,MAAM,MAAM,kDAAkD;YACnF,QAAQ;YACR,SAAS;gBACL,eAAe,CAAC,OAAO,EAAE,QAAQ,GAAG,CAAC,mBAAmB,EAAE;gBAC1D,gBAAgB;YACpB;YACA,MAAM,KAAK,SAAS,CAAC;gBACjB;gBACA,QAAQ;gBACR,cAAc,GAAG,QAAQ,GAAG,CAAC,oBAAoB,IAAI,wBAAwB,OAAO,CAAC;gBACrF,UAAU;oBACN,WAAW;oBACX,eAAe,EAAE;gBACrB;YACJ;QACJ;QAEA,MAAM,OAAO,MAAM,iBAAiB,IAAI;QAExC,IAAI,CAAC,iBAAiB,EAAE,EAAE;YACtB,QAAQ,KAAK,CAAC,kCAAkC;YAChD,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,KAAK,OAAO,IAAI;YAAoC,GAAG;gBAAE,QAAQ,iBAAiB,MAAM;YAAC;QAC/H;QAGA,OAAO,+QAAY,CAAC,IAAI,CAAC;YACrB,mBAAmB,KAAK,IAAI,CAAC,iBAAiB;YAC9C,aAAa,KAAK,IAAI,CAAC,WAAW;YAClC,WAAW,KAAK,IAAI,CAAC,SAAS;QAClC;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gDAAgD;QAC9D,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}